---
title: "DESeq graph"
output: html_notebook
---


```{r message=FALSE, warning=FALSE}
library(dplyr)
library(DESeq2)
library(ggplot2)
devtools::load_all(reset=FALSE)

```

```{r}

load("res_ATN1_CP1_v2_p0.05.rda")
res_ATN1_CP1_v2 %>% head
head(res_ATN1_CP1_v2$genus)
str(res_ATN1_CP1_v2$genus)

```

```{r}

res_ATN1_CP1_v2$genus

p1=
  res_ATN1_CP1_v2 %>%
    tidyr::separate(col="genus", into=c("Domain","Phylum","Class","Order","Family","Genus"), sep=";") %>%
mutate(Genus = Genus %>% gsub("D_5__","",.)) %>%
mutate(Family = Family %>% gsub("D_4__","",.)) %>%
 mutate(Phylum = Phylum %>% gsub("D_1__","",.)) %>% 
  subset (!"Ambiguous_taxa" %in% Genus) %>% 
    ggplot(aes(x=Genus,y=log2FoldChange, color=Phylum)) + geom_point(size=3) +
    theme_set(theme_bw())+
  geom_hline(yintercept=0, color = "gray", linetype="dashed")+
  theme(axis.text.x = element_text(angle = -90, hjust = 0))+
  theme(axis.title.x = element_text(color="black", face="bold", size=13),
        axis.title.y = element_text(color="black", size=12, face="bold"),
        axis.text.y = element_text(color="black", size=10, face="bold"),
        axis.text.x = element_text(color="black", size=10, face="bold"),
        legend.text = element_text(color="black", size=10, face="bold"),
        legend.title = element_text(color="black", size=12, face="bold"))





  
```

